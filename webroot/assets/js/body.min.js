function uploaderRefresh(t,e,a){if(theUpdate=t._element.id,"inline"==t._options.mhMode){var i=t._options.mhRefresh+"/"+e;$("#"+t._options.mhField).val(a)}else var i=t._options.mhRefresh;previewUpdate(t,i,theUpdate,!1)}function firstTimeInlinePreview(t){theField=t._options.mhField,theFile=basename($("#"+theField).val()),theUpdate=t._element.id,theRefresh=t._options.mhRefresh+"/"+theFile,previewUpdate(t,theRefresh,theUpdate,!0)}function hidePreview(t){$("#"+t).find(".qq-upload-preview-list").hide("slide",{direction:"left"},1e3)}function showPreview(t){$("#"+t).find(".qq-upload-preview-list").show("slide",{direction:"up"},1e3)}function previewUpdate(t,e,a,i){theBusy=jsVars.assets+"ajax-loader.gif",$("#"+a).find(".qq-upload-preview-list").fadeIn(),$("#"+a).find(".qq-upload-preview-list").html('<img scr="'+theBusy+'" />'),$.ajax({url:e,global:!1,async:i,data:{class:t._options.mhClass,fk:t._options.mhFk,field:t._options.mhModelField},success:function(t){$("#"+a).find(".qq-upload-preview-list").hide(),$("#"+a).find(".qq-upload-preview-list").html(t),showPreview(a)}})}function basename(t){return t.split("/").reverse()[0]}$(".mh-check-all").toggleClick(function(){var t=$(this).attr("mh-target");$("[id^="+t+"]").prop("checked",!0),$(this).val($(this).attr("mh-message-uncheck"))},function(){var t=$(this).attr("mh-target");$("[id^="+t+"]").prop("checked",!1),$(this).val($(this).attr("mh-message-check"))}),$(".mh-clearfield").click(function(t){var e=$(this).attr("mh-target");$(e).val("");var a=e+"-alt";void 0!=a&&$(a).val("")});var d=new Date,fd=pad(d.getDate())+"-"+pad(d.getMonth()+1)+"-"+d.getFullYear();if($(".mh-date").datepicker({dateFormat:"dd-mm-yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0,showButtonPanel:!0,showOn:"focus",altField:"alt",altFormat:"yy-mm-dd"}),$(".mh-date").datepicker($.datepicker.regional.es),$(".mh-date").each(function(){$(this).datepicker("option","altField",$(this).attr("mh-altfield")),$(this).datepicker("option","altFormat","yy-mm-dd")}),$.fn.multiDatesPicker&&($(".mh-multidate").multiDatesPicker({dateFormat:"dd-mm-yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0,showButtonPanel:!0,showOn:"focus",altField:"#alt",altFormat:"yy-mm-dd"}),$(".mh-multidate").multiDatesPicker($.datepicker.regional.es),$("#ui-datepicker-div").css("clip","auto"),$(".mh-multidate").each(function(){$(this).datepicker("option","altField",$(this).attr("mh-altfield")),$(this).datepicker("option","altFormat","yy-mm-dd")}),$(".mh-date-range").multiDatesPicker({dateFormat:"dd-mm-yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0,showButtonPanel:!0,showOn:"focus",altField:"#alt",altFormat:"yy-mm-dd",maxPicks:2}),$(".mh-date-range").multiDatesPicker($.datepicker.regional.es),$(".mh-date-range").each(function(){$(this).datepicker("option","altField",$(this).attr("mh-altfield")),$(this).datepicker("option","altFormat","yy-mm-dd")})),$(".mh-bind").off("click").on("click",function(t){$("#mh-permissions-busy-indicator").fadeIn();var e=$(this).attr("mh-update");return $.ajax({data:{owm:$(this).attr("mh-owner-model"),owid:$($(this).attr("mh-owner-id")).val(),obm:$(this).attr("mh-object-model"),obid:$(this).attr("mh-object-id"),access:$($(this).attr("mh-access")).val(),cburl:$(this).attr("mh-url")},url:owVars.Url.bind,success:function(t){$(e).html(t)},complete:function(t){$("#mh-permissions-busy-indicator").fadeOut()}}),!1}),$(".mh-unbind").off("click").on("click",function(t){$("#mh-permissions-busy-indicator").fadeIn();var e=$(this).attr("mh-update");return $.ajax({data:{owm:$(this).attr("mh-owner-model"),owid:$(this).attr("mh-owner-id"),obm:$(this).attr("mh-object-model"),obid:$(this).attr("mh-object-id"),cburl:$(this).attr("mh-url")},url:owVars.Url.unbind,success:function(t){$(e).html(t)},complete:function(t){$("#mh-permissions-busy-indicator").fadeOut()}}),!1}),$(".mh-rebind").off("change").on("change",function(t){$("#mh-permissions-busy-indicator").fadeIn();var e=$(this).attr("mh-update");return $.ajax({data:{owm:$(this).attr("mh-owner-model"),owid:$(this).attr("mh-owner-id"),obm:$(this).attr("mh-object-model"),obid:$(this).attr("mh-object-id"),access:$(this).val(),cburl:$(this).attr("mh-url")},url:owVars.Url.rebind,success:function(t){$(e).html(t)},complete:function(t){$("#mh-permissions-busy-indicator").fadeOut()}}),!1}),$(".mh-disclose").toggleClick(function(){event.preventDefault();var t=$(this).attr("mh-target");$(t).show();var e=$(this).attr("mh-readonly-field");$("input[id^="+e+"]").prop("readonly",!0)},function(){event.preventDefault();var t=$(this).attr("mh-target");$(t).hide();var e=$(this).attr("mh-readonly-field");$("input[id^="+e+"]").prop("readonly",!1)}),$(".mh-show-by-value").on("change",function(t){var e=$(this).val(),a=$(this).attr("mh-show-on-empty"),i=$(this).attr("mh-show-on-value");0==e?($(i).hide(),$(a).show()):($(a).hide(),$(i).show())}),$(window).on("load",function(t){$(".mh-show-by-value").trigger("change")}),$(".mh-translate").click(function(t){t.stopPropagation(),t.preventDefault();var e="#"+$(this).attr("sfield"),a="#"+$(this).attr("tfield");$(a+"-busy").fadeIn(),$.get(jsVars.translate,{text:$(e).val(),sl:$(this).attr("sl"),tl:$(this).attr("tl")},function(t,e,i){$(a).val(t),$(a+"-busy").fadeOut()})}),setTimeout(function(){$(".mh-flash").fadeOut("slow",function(){$(this).remove()})},6e3),$(".mh-flash").fadeIn("slow"),"undefined"!=typeof qq){$(".uploader").on("click",".mh-uploader-cleaner",function(t){$("#"+$(this).attr("mh_target")).val(""),$(this).parent().parent().find(".qq-upload-preview-list").html("")});var uploaders=new Array;$(".uploader").each(function(t){var e=new qq.FileUploader({debug:!1,element:$(this)[0],action:$(this).attr("mh-upload"),multiple:"1"==$(this).attr("mh-multiple"),allowedExtensions:jsVars.extensions[$(this).attr("mh-extensions")],sizeLimit:0,mhMode:$(this).attr("mh-mode"),mhRefresh:$(this).attr("mh-refresh"),mhDiv:$(this).attr("id"),mhClass:$(this).attr("mh-class"),mhFk:$(this).attr("mh-fk"),mhModelField:$(this).attr("mh-field"),mhField:$(this).attr("mh-target"),mhCompleteUrl:$(this).attr("mh-complete-url"),mhCompleteUpdate:$(this).attr("mh-complete-update"),uploadButtonText:"Haz clic para seleccionar archivos.",dragText:"Arrastra archivos aqu√≠.",hideShowDropArea:!0,template:'<div class="qq-uploader"><div class="qq-upload-manage small-3 columns"><div class="qq-upload-drop-area"><span>{dragText}</span></div><div class="qq-upload-button">{uploadButtonText}</div></div><div class="qq-upload-preview-list"></div><div class="qq-upload-progress-info small-9 columns"><ul class="qq-upload-list"></ul></div></div>',fileTemplate:'<li><span class="qq-progress-bar"></span><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><span class="qq-upload-failed-text">{failUploadtext}</span></li>',params:{class:$(this).attr("mh-class"),plugin:$(this).attr("mh-plugin"),field:$(this).attr("mh-field"),fk:$(this).attr("mh-fk"),limit:$(this).attr("mh-limit"),extensions:jsVars.extensions[$(this).attr("mh-extensions")].toString()},onComplete:function(t,a,i){"inline"==e._options.mhMode&&uploaderRefresh(e,i.file,i.path),void 0!=e._options.mhCompleteUrl&&$.get(e._options.mhCompleteUrl,function(t,a,i){$(e._options.mhCompleteUpdate).html(t)});var r=e._getItemByFileId(t);$(r).fadeOut(1600,"linear")},onProgress:function(t,a,i,r){var n=e._getItemByFileId(t),s=e._find(n,"size");hidePreview(e._element.id),s.style.display="inline";var o,l=Math.round(i/r*100);o=i!=r?l+"% de "+e._formatSize(r):e._formatSize(r),e._find(n,"progressBar").style.width=l+"%",qq.setText(s,o)}});if("inline"==e._options.mhMode){var a=$("<button/>",{text:"Borrar",id:"Clear-"+e._options.mhField,type:"button",mh_target:e._options.mhField,class:"mh-uploader-cleaner mh-webkit-reset mh-button mh-button-delete mh-btn-uploader-clear",click:"return false;"});$(this).find(".qq-upload-manage").append(a),firstTimeInlinePreview(e)}else hidePreview(e._element.id);uploaders.push(e)})}$(".mh-ajax-add").off("click").on("click",function(t){return $.ajax({async:!0,dataType:"html",evalScripts:!0,url:$(this).attr("mh-url"),beforeSend:function(e){$($(t.target).attr("mh-indicator")).fadeIn()},success:function(e,a){$($(t.target).attr("mh-update")).html(e)},complete:function(e,a){$($(t.target).attr("mh-update")).foundation("reveal","open"),$($(t.target).attr("mh-indicator")).fadeOut()}}),!1}),$(".mh-ajax-send").off("click").on("click",function(t){return $.ajax({data:$(this).closest("form").serialize(),dataType:"html",evalScripts:!0,type:"post",url:$(this).attr("mh-url"),beforeSend:function(e){$($(t.target).attr("mh-close")).foundation("reveal","close"),$($(t.target).attr("mh-indicator")).fadeIn()},success:function(e,a){$($(t.target).attr("mh-update")).html(e)},complete:function(e,a){$($(t.target).attr("mh-indicator")).fadeOut()}}),!1}),$(".mh-ajax-btn-reveal").off("click").on("click",function(t){return $.ajax({dataType:"html",evalScripts:!0,url:$(this).attr("href"),beforeSend:function(e){$($(t.target).attr("mh-indicator")).fadeIn()},success:function(e,a){$($(t.target).attr("mh-update")).html(e)},complete:function(e,a){$($(t.target).attr("mh-update")).foundation("reveal","open"),$($(t.target).attr("mh-indicator")).fadeOut()}}),!1}),$(document).off("close.fndtn.reveal").on("close.fndtn.reveal","[data-reveal]",function(){var t=($(this),$(this).attr("mh-url"));return void 0!=t&&($.getJSON(t,function(t){return $.each(t,function(t,e){$("#"+t).val(e)}),console.log("Form updated"),!1}),!1)}),$(".mh-parent-select").on("change",function(t){return $.ajax({async:!0,global:!1,data:{key:$(this).val()},dataType:"html",url:$(this).attr("mh-url"),beforeSend:function(e,a){$($(t.target).attr("mh-indicator")).fadeIn()},success:function(e,a){$($(t.target).attr("mh-update")).html(e)},complete:function(e,a){$($(t.target).attr("mh-indicator")).fadeOut()}}),!1});